(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;a=self;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Templating=c.Templating||{};e=d.Runtime=d.Runtime||{};f=e.Server=e.Server||{};g=f.TemplateInitializer=f.TemplateInitializer||{};h=b&&b.Obj;i=f.TemplateInstances=f.TemplateInstances||{};j=f.Handler=f.Handler||{};k=f.ProviderBuilder=f.ProviderBuilder||{};l=f.TemplateInstance=f.TemplateInstance||{};m=e.Client=e.Client||{};n=b&&b.Collections;o=n&&n.Dictionary;p=a.IntelliFactory;q=p&&p.Runtime;r=b&&b.Arrays;s=c&&c.Var$1;t=b&&b.Operators;u=c&&c.Doc;v=c&&c.Client;w=v&&v.Templates;x=b&&b.Slice;y=c&&c.BindVar;z=c&&c.View;A=a.console;B=b&&b.Activator;C=n&&n.HashSet;D=b&&b.Enumerator;E=b&&b.Seq;F=a.System;G=F&&F.Guid;g.$cctor=function(){g.$cctor=a.ignore;g.initialized=new o.New$5();};g=f.TemplateInitializer=q.Class({get_Vars:function(){g.$cctor();return this.vars;},get_Id:function(){g.$cctor();return this.id;},InitInstance:function(H){var I,J,K,L,M,N,O,P;g.$cctor();J=g.GetHolesFor(H);K=this.vars;for(L=0,M=K.length-1;L<=M;L++){N=r.get(K,L);O=N[1];P=N[0];!J.ContainsKey(P)?J.set_Item(P,O===0?{$:8,$0:P,$1:s.Create$1("")}:O===1?{$:13,$0:P,$1:s.Create$1(0)}:O===2?{$:9,$0:P,$1:s.Create$1(false)}:t.FailWith("Invalid value type")):void 0;}this.instance=new l.New({$:0,$0:J},u.get_Empty());},get_Instance:function(){g.$cctor();return q.GetOptional(this.instance).$0;},$postinit:function(H){g.$cctor();w.RunFullDocTemplate([]);},$init:function(H){g.$cctor();},$preinit:function(H){var I,J,K,L,M,N,O,P;g.$cctor();this.InitInstance(H);I=self.document.querySelectorAll("[ws-var^='"+H+"::']");for(J=0,K=I.length-1;J<=K;J++){L=I[J];M=L.getAttribute("ws-var");N=x.string(M,{$:1,$0:H.length+2},null);O=this.get_Instance().Hole(N);P={$:O.$,$0:M,$1:O.$1};w.GlobalHoles().set_Item(P.$0,P);g.applyVarHole(L,O);}}},h,g);g.applyVarHole=function(H,I){var J,K,L,M,N,O,P;g.$cctor();switch(I.$==9?1:I.$==10?2:I.$==11?3:I.$==12?4:I.$==13?5:I.$==0?(J=I.$0,6):I.$==1?(J=I.$0,6):I.$==2?(J=I.$0,6):I.$==14?(J=I.$0,6):I.$==4?(J=I.$0,6):I.$==5?(J=I.$0,6):I.$==6?(J=I.$0,6):I.$==7?(J=I.$0,6):I.$==3?(J=I.$0,6):0){case 0:K=I.$1;(((y.StringApply())(K))(function(Q){Q(H);}))(function(Q){z.Sink(Q(H),K.get_View());});break;case 1:L=I.$1;(((y.BoolCheckedApply())(L))(function(Q){Q(H);}))(function(Q){z.Sink(Q(H),L.get_View());});break;case 2:M=I.$1;(((y.IntApplyChecked())(M))(function(Q){Q(H);}))(function(Q){z.Sink(Q(H),M.get_View());});break;case 3:N=I.$1;(((y.IntApplyUnchecked())(N))(function(Q){Q(H);}))(function(Q){z.Sink(Q(H),N.get_View());});break;case 4:O=I.$1;(((y.FloatApplyChecked())(O))(function(Q){Q(H);}))(function(Q){z.Sink(Q(H),O.get_View());});break;case 5:P=I.$1;(((y.FloatApplyUnchecked())(P))(function(Q){Q(H);}))(function(Q){z.Sink(Q(H),P.get_View());});break;case 6:A.warn("Not a var hole: ",J);break;}};g.GetOrAddHoleFor=function(H,I,J){var K,L,M,N;g.$cctor();K=g.GetHolesFor(H);L=(M=null,[K.TryGetValue(I,{get:function(){return M;},set:function(O){M=O;}}),M]);return L[0]?L[1]:(N=J(),(K.set_Item(I,N),N));};g.GetHolesFor=function(H){var I,J,K;g.$cctor();I=(J=null,[g.initialized.TryGetValue(H,{get:function(){return J;},set:function(L){J=L;}}),J]);return I[0]?I[1]:(K=new o.New$5(),(g.initialized.set_Item(H,K),K));};g.get_Initialized=function(){g.$cctor();return g.initialized;};g.New=q.Ctor(function(H,I){g.$cctor();h.New.call(this);this.vars=I;q.SetOptional(this,"instance",null);this.id=H;},g);i=f.TemplateInstances=q.Class({},h,i);i.GetInstance=function(H){return(B.Instances())[H].get_Instance();};i.New=q.Ctor(function(){h.New.call(this);},i);j.EventQ2$184$36=function(H,I){return function(J){return function(K){return I({Vars:i.GetInstance(H),Target:J,Event:K});};};};j.CompleteHoles=function(H,I,J){var L,M,N,O,P;function K(Q,R){var S;return M.Contains(Q)?null:(S=R===0?g.GetOrAddHoleFor(H,Q,function(){return{$:8,$0:Q,$1:s.Create$1("")};}):R===1?g.GetOrAddHoleFor(H,Q,function(){return{$:13,$0:Q,$1:s.Create$1(0)};}):R===2?g.GetOrAddHoleFor(H,Q,function(){return{$:9,$0:Q,$1:s.Create$1(false)};}):t.FailWith("Invalid value type"),(L.set_Item(Q,S),{$:1,$0:S}));}L=new o.New$5();M=new C.New$3();N=D.Get(I);try{while(N.MoveNext()){O=N.Current();P=O.$0;M.Add(P);L.set_Item(P,O);}}finally{if(typeof N=="object"&&"Dispose"in N)N.Dispose();}return[E.append(I,r.choose(function(Q){return K(Q[0],Q[1]);},J)),{$:0,$0:L}];};j.EventQ2=function(H,I,J,K){return{$:5,$0:I,$1:function(L){return function(M){return K({Vars:J(),Target:L,Event:M});};}};};k=f.ProviderBuilder=q.Class({},h,k);k.New=q.Ctor(function(H){var I;h.New.call(this);this.i=null;this.k=(I=G.NewGuid(),a.String(I));this.h=[];this.s=H;},k);k.New$1=q.Ctor(function(){var H;h.New.call(this);this.i=null;this.k=(H=G.NewGuid(),a.String(H));this.h=[];q.SetOptional(this,"s",null);},k);l=f.TemplateInstance=q.Class({Hole:function(H){return this.allVars.get_Item(H);},get_Doc:function(){return this.doc;}},h,l);l.New=q.Ctor(function(H,I){h.New.call(this);this.doc=I;this.allVars=H.$==0?H.$0:t.FailWith("Should not happen");},l);m.AfterRenderQ2$57$26=function(H){return function(){H();};};m.Box=a.id;}());
